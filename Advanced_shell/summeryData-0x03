#!/bin/bash



OUTPUT_CSV="pokemon_report.csv"

# Check if there are JSON files
if ! ls *.json >/dev/null 2>&1; then
    echo "No JSON files found. Run Task 2 script first."
    exit 1
fi

# Create CSV header
echo "Name,Height(m),Weight(kg)" > "$OUTPUT_CSV"

# Loop through all JSON files
for file in *.json; do
    name=$(jq -r '.name' "$file")
    height=$(jq -r '.height' "$file")
    weight=$(jq -r '.weight' "$file")

    # Convert to meters and kilograms
    height_m=$(echo "$height" | awk '{printf "%.1f", $1/10}')
    weight_kg=$(echo "$weight" | awk '{printf "%.1f", $1/10}')

    # Append to CSV
    echo "${name^},$height_m,$weight_kg" >> "$OUTPUT_CSV"
done

echo "âœ… Report generated: $OUTPUT_CSV"

# Calculate averages using awk
awk -F',' 'NR>1 {total_h+=$2; total_w+=$3; count++} 
    END {printf "Average Height: %.2fm\nAverage Weight: %.2fkg\n", total_h/count, total_w/count}' "$OUTPUT_CSV"

